hours = [0
1
2
3
4
5
6
7
8
9
10
9
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
];
hydrogen = [49
48.4569
48.2267
47.9809
47.8418
47.5092
47.4237
48.2036
48.4731
48.5073
48.3087
47.9742
47.8401
47.6054
47.6142
47.8101
47.9988
48.282
48.3685
48.4112
48.5047
48.5982
48.6428
48.6887
47.5748
47.5089
47.5204
47.5719
47.5714
47.4263
47.3335
47.3857
47.289
47.2432
47.2934
47.2445
47.3906
47.0968
47.0071
47.0119
47.2548
47.3453
47.8244
48.2931
48.4199
48.6038
48.9346
49.2613
49.1516
49.054
49.298
49.2439
49.34
49.3372
49.143
48.7614
47.8555
47.2564
46.2191
46.8358
45.7671
45.3112
45.7193
45.0868
44.8125
44.9214
44.8261
45.0707
45.3549
45.974
46.4372
46.4658
43.8031
43.6777
43.8974
44.19
44.4244
44.6574
44.6964
44.0159
43.3083
42.3186
41.2421
40.219
40.7885
41.0295
40.3467
40.4581
39.9605
39.9531
39.9498
39.9535
39.9609
39.9698
40.0315
40.3778
43.0806
42.9558
43.0786
43.0205
43.1152
43.2571
43.2524
43.6376
43.1919
42.9103
42.6791
42.2538
42.1232
43.4365
42.2446
41.4927
41.4705
41.4319
41.6292
41.9637
42.4368
42.8075
42.7922
42.8356
44.1873
44.1974
44.233
44.2282
44.2749
44.3216
44.2716
44.3205
44.3196
44.3192
44.1742
44.1297
43.3593
43.8154
43.2789
42.7116
42.7307
43.075
42.9714
43.503
44.4076
44.668
45.2315
44.2446
48.4777
48.5036
48.8055
48.7377
48.782
48.2478
48.0688
47.885
48.0383
47.7465
47.5605
47.5682
47.5704
47.7644
47.7107
47.8556
47.7549
47.5145
47.3286
47.9648
48.1908
48.276
48.4148
48.6028
47.5809
47.5588
47.4711
47.573
47.7168
47.809
47.7084
48.1452
48.1815
47.7416
47.8491
47.7532
47.6592
47.5177
47.5228
47.476
47.7194
47.713
47.8078
47.853
47.6574
47.4205
47.622
47.9092

]; 
heat = [40
44.817
43.9337
42.828
42.157
40.6766
40.2223
43.57
44.9939
45.2594
44.3846
42.8416
42.157
41.0904
41.0583
41.8933
42.7669
44.0877
44.5679
44.8023
45.2519
45.7123
45.9512
46.1835
41.2059
40.6451
40.6324
40.8386
40.8449
40.2284
39.8025
39.9935
39.594
39.3801
39.5757
39.38
39.9812
38.7907
38.3586
38.347
39.3439
39.778
41.8539
44.0593
44.7879
45.6972
47.3571
49.0333
48.5784
48.0971
49.2971
49.0549
49.5309
49.5346
48.5948
46.7202
42.4827
39.6606
35.3021
37.4724
33.417
31.5522
32.9097
30.6871
29.6284
29.9366
29.6125
30.4392
31.4828
33.806
35.7149
35.9555
26.5363
25.7439
26.3372
27.2781
28.0894
28.9135
29.0957
26.8702
24.5671
21.5863
18.6021
16.0152
17.215
17.8175
16.2262
16.4251
12.8392
12.4316
12.5003
13.0936
13.5551
14.1792
15.4113
16.1911
23.1963
23.2115
23.6323
23.4992
23.7804
24.2168
24.2257
25.3994
24.1051
23.2254
22.5138
21.2848
20.8677
24.589
21.3218
19.2115
19.0541
18.9292
19.4216
20.3164
21.6447
22.7602
22.7819
22.9208
27.0424
27.2957
27.4561
27.4597
27.6171
27.7787
27.6243
27.7787
27.7824
27.7824
27.3099
27.1431
24.7195
26.0099
24.4064
22.6733
22.6408
23.6208
23.3578
24.9365
27.8757
28.9097
30.9306
27.6926
43.7463
45.0158
46.6045
46.432
46.6507
44.2086
43.2637
42.382
42.9941
41.7423
40.8703
40.8449
40.8449
41.6769
41.4939
42.1171
41.7162
40.6639
39.8147
42.4869
43.6464
44.1158
44.7878
45.6968
41.193
40.8513
40.4332
40.832
41.4679
41.9065
41.5005
43.3961
43.6746
41.762
42.1237
41.7163
41.2853
40.6513
40.6324
40.4269
41.455
41.4873
41.9064
42.1304
41.2982
40.2408
41.0328
42.3152

];

wind = [88.750949
90.293251
92.601445
94.943193
97.679965
98.850022
99.100837
99.382052
99.238043
99.349675
99.356365
99.333389
99.383457
99.278348
99.128934
99.122275
99.375851
99.195918
98.507267
97.685474
96.489627
92.980903
89.190383
86.740936
26.222646
25.343918
27.907221
30.633557
30.509491
30.188681
32.822538
31.990499
25.590066
26.332091
38.080872
49.16786
54.587354
57.749304
59.427451
59.39134
57.882151
54.29725
54.086295
56.603001
54.587368
50.634278
46.900932
43.229483
5.77891
3.129872
1.549057
0.716795
0.413059
1.095603
3.165853
6.867586
10.653679
14.436677
18.870301
24.356035
27.905152
29.307875
29.040348
25.193696
20.474632
13.290124
7.482077
4.426706
7.58319
20.709728
37.600406
51.959945
71.760561
67.431457
60.689148
53.278167
48.115306
46.490986
41.149653
28.384259
22.338246
23.008658
24.853248
28.608043
31.151452
31.415206
30.777014
29.767001
29.044578
30.128316
32.681769
35.892824
44.830193
58.727891
70.017108
76.733954
75.839049
79.043579
79.285795
78.669285
78.198107
77.243433
76.661851
74.69725
77.480106
78.786739
79.793231
80.934875
81.937291
82.505947
83.062074
83.75064
84.292071
82.669919
80.757825
79.381122
77.206858
79.324886
84.478143
85.345637
41.444907
34.188088
44.850676
56.28377
48.165889
50.929367
52.996879
52.985806
56.227548
52.567046
49.573244
49.429618
51.394572
57.369278
60.948575
59.64462
56.074862
53.408634
47.225525
35.73421
26.468626
31.732329
50.21049
65.482238
37.547003
45.931625
50.525668
55.714664
64.016641
70.894933
76.095485
79.305323
82.310382
82.674717
82.333159
82.348441
76.273889
63.028409
68.626596
86.850573
93.921445
94.476638
92.628803
90.811928
87.753325
84.58158
81.326929
77.500611
71.138664
68.130061
68.972071
74.136082
77.857683
79.975279
81.0362
80.584682
78.76055
78.973695
81.306589
83.17251
87.300527
89.706955
90.078552
89.70355
89.807618
89.856165
88.915665
87.42767
85.747873
84.459467
82.105607
77.335324
];

pv = [0
0
0
0
0
0
0
0
0.291983
5.718923
15.337419
43.767656
69.304444
68.046914
58.793726
37.387539
8.831553
0
0
0
0
0
0
0
0
0
0
0
0
0
0
1.816785
6.871221
17.31858
27.314793
32.821879
43.796938
53.617628
49.577106
40.423999
25.787706
10.674833
2.161488
0
0
0
0
0
0
0
0
0
0
0
1.133936
9.059934
19.523916
32.100078
40.728161
44.094185
47.254563
48.6245
66.037782
65.517127
69.020134
60.238669
52.116871
20.423694
6.726103
0
0
0
0
0
0
0
0
1.319422
28.059453
55.175157
68.630187
73.960699
75.949034
76.473695
79.906414
82.589026
83.392126
80.710341
76.771579
71.310144
56.567394
28.313547
8.406849
0.710453
0
0
0
0
0
0
0
0
6.131878
32.616535
57.877971
71.421408
78.620469
82.635249
84.398683
85.113818
84.351829
82.807878
79.625623
74.116278
64.261721
46.923725
17.515946
0
0
0
0
0
0
0
0
0
0
0
2.462303
9.680163
17.168832
30.349142
56.53102
75.573886
78.800828
79.787169
77.484171
67.067936
43.352895
7.967569
0
0
0
0
0
0
0
0
0
0
0
0
0.026135
1.112383
1.993581
2.42823
2.954324
3.757545
4.91763
5.363456
4.976757
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0.714301
2.855208
3.496021
5.156988
11.045929
17.395415
14.964246
0.72125
0
0
0
0
0
0
0

];

demand = [hydrogen + heat];
generation = [wind + pv];
% M = [hydrogen.';
%     heat.';
%     wind.';
%     pv.'];
% figure
% basevalue = 0;
% %plot (hours,hydrogen*50, hours,heat*50,hours,wind*50,hours,pv*50,'LineWidth',1);
% area (M,1./hours);
% %trapz (hourM);
% % title('Normalized Hourly Demand Profiles')
% % xlabel('Time[h]')
% % xticks([0 12 24 36 48 60 72 84 96 108 120 132 144 156 168 180 192])
% % xline(23,'--r',{'07.02.2019'});
% % xline(47,'--r',{'23.03.2019'});
% % xline(71,'--r',{'07.05.2019'});
% % xline(95,'--r',{'23.06.2019'});
% % xline(119,'--r',{'07.08.2019'});
% % xline(143,'--r',{'23.09.2019'});
% % xline(167,'--r',{'07.11.2019'});
% % xline(191,'--r',{'23.12.2019'});
% % ylabel('Q(t)/Qmax [m^3/s]')
% % xlim([0 192])
% %ylim([0.1 2.0])
% %legend('Industrial Hydrogen','District Heating','Wind Farm','PV Farm')

% figure
% plot (hours,(hydrogen), hours,(heat),'LineWidth',2);
% title('Hourly {P_{load}} of PtX Calculated From OM Models','FontSize',15)
% xlabel('Time[h]','FontSize',15)
% xticks([0 12 24 36 48 60 72 84 96 108 120 132 144 156 168 180 192])
% xline(23,'--r',{'07.02.2019'});
% xline(47,'--r',{'23.03.2019'});
% xline(71,'--r',{'07.05.2019'});
% xline(95,'--r',{'23.06.2019'});
% xline(119,'--r',{'07.08.2019'});
% xline(143,'--r',{'23.09.2019'});
% xline(167,'--r',{'07.11.2019'});
% xline(191,'--r',{'23.12.2019'});
% ylabel('Q(t)/{Q_{max}} x 50 [MW]','FontSize',15)
% xlim([0 192])
% %ylim([0.5 1.2])
% legend('Industrial Hydrogen','District Heating','Location','southeast','FontSize',15)

figure
plot (hours,(wind),hours,(pv),'LineWidth',1);
%title('Power Capacity of RES','FontSize',15)
xlabel('Time[h]','FontSize',15)
xticks([0 12 24 36 48 60 72 84 96 108 120 132 144 156 168 180 192])
xline(23,'--y',{'07.02.2019'});
xline(47,'--y',{'23.03.2019'});
xline(71,'--y',{'07.05.2019'});
xline(95,'--y',{'23.06.2019'});
xline(119,'--y',{'07.08.2019'});
xline(143,'--y',{'23.09.2019'});
xline(167,'--y',{'07.11.2019'});
xline(191,'--y',{'23.12.2019'});
ylabel('Active Power [MW] ','FontSize',15)
xlim([0 192])
%ylim([0 2.0])
legend('Wind Farm','PV Farm','Location','southeast','FontSize',8)
% Set x and y font sizes
set(gca,'FontSize',6)
set(gcf, 'PaperPosition', [0 0 14 6]); 
set(gcf, 'PaperSize', [14 6]); %Set the paper to have width 5 and height 5.
saveas(gcf,'powercapacityofres2.pdf')
system('pdfcrop powercapacityofres2.pdf powercapacityofres2.pdf');

figure
plot (hours,generation,hours,(demand+20),'LineWidth',1)
%title('Flexible Demand of MES','FontSize',15)
xlim([0 192])
xticks([0 12 24 36 48 60 72 84 96 108 120 132 144 156 168 180 192])
xline(23,'--y',{'07.02.2019'});
xline(47,'--y',{'23.03.2019'});
xline(71,'--y',{'07.05.2019'});
xline(95,'--y',{'23.06.2019'});
xline(119,'--y',{'07.08.2019'});
xline(143,'--y',{'23.09.2019'});
xline(167,'--y',{'07.11.2019'});
xline(191,'--y',{'23.12.2019'});
xlabel('Time [h]','FontSize',10)
ylabel('Active Power [MW]','FontSize',15)
legend('Total Generation of MES','Total Demand of MES','Location','southeast','FontSize',8)
set(gca,'FontSize',6)
set(gcf, 'PaperPosition', [0 0 16 6]); 
set(gcf, 'PaperSize', [16 6]); %Set the paper to have width 5 and height 5
saveas(gcf,'flexibledemandofmes2.pdf')
system('pdfcrop flexibledemandofmes2.pdf flexibledemandofmes2.pdf');
