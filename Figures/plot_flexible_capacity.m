hours = [0
1
2
3
4
5
6
7
8
9
10
9
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
];
hydrogen = [0.983333333
0.982407407
0.978703704
0.974074074
0.971296296
0.964814815
0.962962963
0.977777778
0.983333333
0.984259259
0.980555556
0.974074074
0.971296296
0.966666667
0.966666667
0.97037037
0.974074074
0.97962963
0.981481481
0.982407407
0.984259259
0.986111111
0.987037037
0.987962963
0.966666667
0.964814815
0.964814815
0.965740741
0.965740741
0.962962963
0.961111111
0.962037037
0.960185185
0.959259259
0.960185185
0.959259259
0.962037037
0.956481481
0.95462963
0.95462963
0.959259259
0.961111111
0.97037037
0.97962963
0.982407407
0.986111111
0.992592593
0.999074074
0.997222222
0.99537037
1
0.999074074
1.000925926
1.000925926
0.997222222
0.989814815
0.972222222
0.960185185
0.939814815
0.950925926
0.930555556
0.921296296
0.928703704
0.916666667
0.911111111
0.912962963
0.911111111
0.915740741
0.921296296
0.933333333
0.942592593
0.943518519
0.892592593
0.888888889
0.892592593
0.898148148
0.902777778
0.907407407
0.908333333
0.89537037
0.881481481
0.862037037
0.840740741
0.82037037
0.830555556
0.835185185
0.822222222
0.824074074
0.814814815
0.814814815
0.814814815
0.814814815
0.814814815
0.814814815
0.815740741
0.822222222
0.874074074
0.873148148
0.875925926
0.875
0.876851852
0.87962963
0.87962963
0.887037037
0.878703704
0.873148148
0.868518519
0.860185185
0.857407407
0.882407407
0.860185185
0.84537037
0.844444444
0.843518519
0.847222222
0.853703704
0.862962963
0.87037037
0.87037037
0.871296296
0.897222222
0.898148148
0.899074074
0.899074074
0.9
0.900925926
0.9
0.900925926
0.900925926
0.900925926
0.898148148
0.897222222
0.882407407
0.890740741
0.880555556
0.869444444
0.869444444
0.875925926
0.874074074
0.884259259
0.901851852
0.907407407
0.918518519
0.9
0.980555556
0.983333333
0.989814815
0.988888889
0.989814815
0.97962963
0.975925926
0.972222222
0.975
0.969444444
0.965740741
0.965740741
0.965740741
0.969444444
0.968518519
0.971296296
0.969444444
0.964814815
0.961111111
0.973148148
0.977777778
0.97962963
0.982407407
0.986111111
0.966666667
0.965740741
0.963888889
0.965740741
0.968518519
0.97037037
0.968518519
0.976851852
0.977777778
0.969444444
0.971296296
0.969444444
0.967592593
0.964814815
0.964814815
0.963888889
0.968518519
0.968518519
0.97037037
0.971296296
0.967592593
0.962962963
0.966666667
0.972222222
]; 
heat = [0.9775
0.97625
0.97125
0.965
0.96125
0.9525
0.95
0.97
0.9775
0.97875
0.97375
0.965
0.96125
0.955
0.955
0.96
0.965
0.9725
0.975
0.97625
0.97875
0.98125
0.9825
0.98375
0.955
0.9525
0.9525
0.95375
0.95375
0.95
0.9475
0.94875
0.94625
0.945
0.94625
0.945
0.94875
0.94125
0.93875
0.93875
0.945
0.9475
0.96
0.9725
0.97625
0.98125
0.99
0.99875
0.99625
0.99375
1
0.99875
1.00125
1.00125
0.99625
0.98625
0.9625
0.94625
0.91875
0.93375
0.90625
0.89375
0.90375
0.8875
0.88
0.8825
0.88
0.88625
0.89375
0.91
0.9225
0.92375
0.855
0.85
0.855
0.8625
0.86875
0.875
0.87625
0.85875
0.84
0.81375
0.785
0.7575
0.77125
0.7775
0.76
0.7625
0.75
0.75
0.75
0.75
0.75
0.75
0.75125
0.76
0.83
0.82875
0.8325
0.83125
0.83375
0.8375
0.8375
0.8475
0.83625
0.82875
0.8225
0.81125
0.8075
0.84125
0.81125
0.79125
0.79
0.78875
0.79375
0.8025
0.815
0.825
0.825
0.82625
0.86125
0.8625
0.86375
0.86375
0.865
0.86625
0.865
0.86625
0.86625
0.86625
0.8625
0.86125
0.84125
0.8525
0.83875
0.82375
0.82375
0.8325
0.83
0.84375
0.8675
0.875
0.89
0.865
0.97375
0.9775
0.98625
0.985
0.98625
0.9725
0.9675
0.9625
0.96625
0.95875
0.95375
0.95375
0.95375
0.95875
0.9575
0.96125
0.95875
0.9525
0.9475
0.96375
0.97
0.9725
0.97625
0.98125
0.955
0.95375
0.95125
0.95375
0.9575
0.96
0.9575
0.96875
0.97
0.95875
0.96125
0.95875
0.95625
0.9525
0.9525
0.95125
0.9575
0.9575
0.96
0.96125
0.95625
0.95
0.955
0.9625
];

wind = [1.77501898
1.80586502
1.8520289
1.89886386
1.9535993
1.97700044
1.98201674
1.98764104
1.98476086
1.9869935
1.9871273
1.98666778
1.98766914
1.98556696
1.98257868
1.9824455
1.98751702
1.98391836
1.97014534
1.95370948
1.92979254
1.85961806
1.78380766
1.73481872
0.52445292
0.50687836
0.55814442
0.61267114
0.61018982
0.60377362
0.65645076
0.63980998
0.51180132
0.52664182
0.76161744
0.9833572
1.09174708
1.15498608
1.18854902
1.1878268
1.15764302
1.085945
1.0817259
1.13206002
1.09174736
1.01268556
0.93801864
0.86458966
0.1155782
0.06259744
0.03098114
0.0143359
0.00826118
0.02191206
0.06331706
0.13735172
0.21307358
0.28873354
0.37740602
0.4871207
0.55810304
0.5861575
0.58080696
0.50387392
0.40949264
0.26580248
0.14964154
0.08853412
0.1516638
0.41419456
0.75200812
1.0391989
1.43521122
1.34862914
1.21378296
1.06556334
0.96230612
0.92981972
0.82299306
0.56768518
0.44676492
0.46017316
0.49706496
0.57216086
0.62302904
0.62830412
0.61554028
0.59534002
0.58089156
0.60256632
0.65363538
0.71785648
0.89660386
1.17455782
1.40034216
1.53467908
1.51678098
1.58087158
1.5857159
1.5733857
1.56396214
1.54486866
1.53323702
1.493945
1.54960212
1.57573478
1.59586462
1.6186975
1.63874582
1.65011894
1.66124148
1.6750128
1.68584142
1.65339838
1.6151565
1.58762244
1.54413716
1.58649772
1.68956286
1.70691274
0.82889814
0.68376176
0.89701352
1.1256754
0.96331778
1.01858734
1.05993758
1.05971612
1.12455096
1.05134092
0.99146488
0.98859236
1.02789144
1.14738556
1.2189715
1.1928924
1.12149724
1.06817268
0.9445105
0.7146842
0.52937252
0.63464658
1.0042098
1.30964476
0.75094006
0.9186325
1.01051336
1.11429328
1.28033282
1.41789866
1.5219097
1.58610646
1.64620764
1.65349434
1.64666318
1.64696882
1.52547778
1.26056818
1.37253192
1.73701146
1.8784289
1.88953276
1.85257606
1.81623856
1.7550665
1.6916316
1.62653858
1.55001222
1.42277328
1.36260122
1.37944142
1.48272164
1.55715366
1.59950558
1.620724
1.61169364
1.575211
1.5794739
1.62613178
1.6634502
1.74601054
1.7941391
1.80157104
1.794071
1.79615236
1.7971233
1.7783133
1.7485534
1.71495746
1.68918934
1.64211214
1.54670648
];

pv = [0
0
0
0
0
0
0
0
0.00583966
0.11437846
0.30674838
0.87535312
1.38608888
1.36093828
1.17587452
0.74775078
0.17663106
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0.0363357
0.13742442
0.3463716
0.54629586
0.65643758
0.87593876
1.07235256
0.99154212
0.80847998
0.51575412
0.21349666
0.04322976
0
0
0
0
0
0
0
0
0
0
0
0.02267872
0.18119868
0.39047832
0.64200156
0.81456322
0.8818837
0.94509126
0.97249
1.32075564
1.31034254
1.38040268
1.20477338
1.04233742
0.40847388
0.13452206
0
0
0
0
0
0
0
0
0.02638844
0.56118906
1.10350314
1.37260374
1.47921398
1.51898068
1.5294739
1.59812828
1.65178052
1.66784252
1.61420682
1.53543158
1.42620288
1.13134788
0.56627094
0.16813698
0.01420906
0
0
0
0
0
0
0
0
0.12263756
0.6523307
1.15755942
1.42842816
1.57240938
1.65270498
1.68797366
1.70227636
1.68703658
1.65615756
1.59251246
1.48232556
1.28523442
0.9384745
0.35031892
0
0
0
0
0
0
0
0
0
0
0
0.04924606
0.19360326
0.34337664
0.60698284
1.1306204
1.51147772
1.57601656
1.59574338
1.54968342
1.34135872
0.8670579
0.15935138
0
0
0
0
0
0
0
0
0
0
0
0
0.0005227
0.02224766
0.03987162
0.0485646
0.05908648
0.0751509
0.0983526
0.10726912
0.09953514
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0.01428602
0.05710416
0.06992042
0.10313976
0.22091858
0.3479083
0.29928492
0.014425
0
0
0
0
0
0
0
];

demand = [(hydrogen + heat)*50];
generation = [(wind + pv)*50];
% M = [hydrogen.';
%     heat.';
%     wind.';
%     pv.'];
% figure
% basevalue = 0;
% %plot (hours,hydrogen*50, hours,heat*50,hours,wind*50,hours,pv*50,'LineWidth',1);
% area (M,1./hours);
% %trapz (hourM);
% % title('Normalized Hourly Demand Profiles')
% % xlabel('Time[h]')
% % xticks([0 12 24 36 48 60 72 84 96 108 120 132 144 156 168 180 192])
% % xline(23,'--r',{'07.02.2019'});
% % xline(47,'--r',{'23.03.2019'});
% % xline(71,'--r',{'07.05.2019'});
% % xline(95,'--r',{'23.06.2019'});
% % xline(119,'--r',{'07.08.2019'});
% % xline(143,'--r',{'23.09.2019'});
% % xline(167,'--r',{'07.11.2019'});
% % xline(191,'--r',{'23.12.2019'});
% % ylabel('Q(t)/Qmax [m^3/s]')
% % xlim([0 192])
% %ylim([0.1 2.0])
% %legend('Industrial Hydrogen','District Heating','Wind Farm','PV Farm')

figure
plot (hours,(hydrogen*50), hours,(heat*50),'LineWidth',2);
title('Hourly {P_{load}} of PtX Calculated From Demand Profiles','FontSize',15)
xlabel('Time[h]','FontSize',15)
xticks([0 12 24 36 48 60 72 84 96 108 120 132 144 156 168 180 192])
xline(23,'--r',{'07.02.2019'});
xline(47,'--r',{'23.03.2019'});
xline(71,'--r',{'07.05.2019'});
xline(95,'--r',{'23.06.2019'});
xline(119,'--r',{'07.08.2019'});
xline(143,'--r',{'23.09.2019'});
xline(167,'--r',{'07.11.2019'});
xline(191,'--r',{'23.12.2019'});
ylabel('Q(t)/{Q_{max}} x 50 [MW]','FontSize',15)
xlim([0 192])
%ylim([0.5 1.2])
legend('Industrial Hydrogen','District Heating','Location','southeast','FontSize',15)

figure
plot (hours,(wind*50),hours,(pv*50),'LineWidth',2);
title('Power Capacity of RES','FontSize',15)
xlabel('Time[h]','FontSize',15)
xticks([0 12 24 36 48 60 72 84 96 108 120 132 144 156 168 180 192])
xline(23,'--r',{'07.02.2019'});
xline(47,'--r',{'23.03.2019'});
xline(71,'--r',{'07.05.2019'});
xline(95,'--r',{'23.06.2019'});
xline(119,'--r',{'07.08.2019'});
xline(143,'--r',{'23.09.2019'});
xline(167,'--r',{'07.11.2019'});
xline(191,'--r',{'23.12.2019'});
ylabel('P(t)/50 MW ','FontSize',15)
xlim([0 192])
%ylim([0 2.0])
legend('Wind Farm','PV Farm','Location','southeast','FontSize',15)


figure
plot (hours,generation,hours,(demand+20),'LineWidth',2)
title('Flexible Demand of PtX','FontSize',15)
xlim([0 192])
xticks([0 12 24 36 48 60 72 84 96 108 120 132 144 156 168 180 192])
xline(23,'--r',{'07.02.2019'});
xline(47,'--r',{'23.03.2019'});
xline(71,'--r',{'07.05.2019'});
xline(95,'--r',{'23.06.2019'});
xline(119,'--r',{'07.08.2019'});
xline(143,'--r',{'23.09.2019'});
xline(167,'--r',{'07.11.2019'});
xline(191,'--r',{'23.12.2019'});
xlabel('Time [h]','FontSize',15)
ylabel('Active Power [MW]','FontSize',15)
legend('Total Generation of MES','Total Demand of MES','Location','southeast','FontSize',15)